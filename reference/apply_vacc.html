<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Apply vaccination activities to a population object — apply_vacc • popim</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Apply vaccination activities to a population object — apply_vacc"><meta property="og:description" content="apply_vacc() applies the vaccination activities listed in the
input object vacc (a data.frame object of class
popim_vacc_activities) to the popim_population object pop,
then returns the updated population object pop."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">popim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/popim.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/technical_doc.html">popim technical documentation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Apply vaccination activities to a population object</h1>

    <div class="hidden name"><code>apply_vacc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>apply_vacc()</code> applies the vaccination activities listed in the
input object <code>vacc</code> (a data.frame object of class
<code>popim_vacc_activities</code>) to the <code>popim_population</code> object <code>pop</code>,
then returns the updated population object <code>pop</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">apply_vacc</span><span class="op">(</span><span class="va">pop</span>, <span class="va">vacc</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-pop">pop<a class="anchor" aria-label="anchor" href="#arg-pop"></a></dt>
<dd><p>An object of class <code>popim_population</code> such as
created by <code><a href="popim_population.html">popim_population()</a></code>.</p></dd>


<dt id="arg-vacc">vacc<a class="anchor" aria-label="anchor" href="#arg-vacc"></a></dt>
<dd><p>An object of class <code>popim_vacc_activities</code> such as
created by <code><a href="popim_vacc_activities.html">popim_vacc_activities()</a></code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The input <code>popim_population</code> class object <code>pop</code> with
updated column <code>immunity</code> to reflect the vaccination
activities supplied in <code>vacc</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Once objects holding data on the population and vaccination activities
have been set up, the primary functionality provided by <code>popim</code> is to
apply the vaccination activities to the population to evaluate the
population immunity by age over time that results from the given
vaccination activities, which is done with the function
<code>apply_vacc()</code>.</p><div class="section">
<h3 id="assumptions-when-applying-vaccination-activities-to-the-population">Assumptions when applying vaccination activities to the population<a class="anchor" aria-label="anchor" href="#assumptions-when-applying-vaccination-activities-to-the-population"></a></h3>

<ul><li><p>100% vaccine effectiveness</p></li>
<li><p>no wastage of doses</p></li>
<li><p>no waning immunity</p></li>
<li><p>mortality is independent of immunity status</p></li>
</ul><p>While the first two are clearly unrealistic assumptions, if there is a
constant vaccine effectiveness (&lt;100%), or a constant wastage factor,
the results can easily be scaled up by these constant factors to
obtain more realistic values for vaccine demand.</p>
<p>For a potentially deadly disease one would expect that mortality due
to the disease would be strongly correlated with immunity status,
however, even the most devastating outbreaks typically only affect a
small part of the population, and therefore all-cause mortality will
be much less impacted by mortality due to the specific disease. This
means that this assumption is closer to reality than it might appear
at first.</p>
<p>Waning immunity is a potentially important factor to consider for many
vaccines, particularly when looking at the long term benefits of
vaccination. However, allowing for this is currently not implemented.</p>
</div>

<div class="section">
<h3 id="description-of-the-algorithm">Description of the algorithm<a class="anchor" aria-label="anchor" href="#description-of-the-algorithm"></a></h3>


<p>The vaccination activities object has columns for <code>coverage</code>, the
proportion of the target population that will be vaccinated, and
<code>doses</code>, the number of vaccine doses to be administered in the
activity. Given a target population size this is redundant (and
potentially conflicting) information. The function <code>apply_vacc()</code> will
always use <code>coverage</code> information in preference over <code>doses</code>, if this
is non-missing. If <code>coverage</code> is missing, the target population size
(based on the population size of the region and age groups targeted)
will be calculated and the corresponding <code>coverage</code> calculated as
<code>doses</code> / <code>target_population</code>.</p>
<p>While the function <code>apply_vacc()</code> will calculate the coverage if it is
missing with respect to the target population size, without modifying
the input <code>popim_vacc_activities</code> object, the function
<code><a href="complete_vacc_activities.html">complete_vacc_activities()</a></code> will fill in missing coverage and doses
information from the other, and check for inconsistencies in
activities that have both data on <code>coverage</code> and <code>doses</code>. This is done
with respect to a particular <code>popim_population</code> object which contains
the relevant population sizes.</p><div class="section">
<h4 id="vaccinating-a-cohort-with-no-previous-immunity">Vaccinating a cohort with no previous immunity<a class="anchor" aria-label="anchor" href="#vaccinating-a-cohort-with-no-previous-immunity"></a></h4>


<p>When vaccination is applied to a particular birth cohort that has no
immunity, the result is simply that the proportion of the cohort
receiving the vaccine will be immune from the time of the vaccination
onwards, i.e., the immunity for this cohort will be set to equal the
coverage of the vaccination activity in question. Due to the annual
time step, vaccination is assumed to take effect at the end of the
year in which it is implemented, so the immunity is updated from the
next year onwards.</p>
</div>

<div class="section">
<h4 id="vaccinating-a-cohort-with-previous-immunity">Vaccinating a cohort with previous immunity<a class="anchor" aria-label="anchor" href="#vaccinating-a-cohort-with-previous-immunity"></a></h4>


<p>When a vaccination activity is applied to a cohort that has some
previous immunity, we need to make some assumptions about who will be
vaccinated in the new activity. There are 3 different options
implemented which are governed by the parameter <code>targeting</code>, one of
the input parameters to the function <code>apply_vacc()</code>. This parameter
can take the values <code>"targeted"</code>, <code>"random"</code> or <code>"correlated"</code>.</p><div class="section">
<h5 id="-targeted-targeting"><code>"targeted"</code> targeting<a class="anchor" aria-label="anchor" href="#-targeted-targeting"></a></h5>


<p>The most effective way to implement a new vaccination activity is to
use <code>"targeted"</code> targeting, meaning that the vaccine is targeted at
previously non-immunised individuals. This means that the new immunity
of after the vaccination activity is simply the sum of the previous
immunity and the coverage of the current vaccination activity (capped
by 1 which indicates complete immunity of the cohort in question):</p>
<p>immunity_new = min(immunity_prev + coverage, 1)</p>
<p>While this is not a realistic assumption in many settings, it can be
useful for instance in multi-year campaigns that target the same
region (but possibly proceed sub-region by sub-region) over several
years. This multi-year campaign would be coded as separate vaccination
activities for each year, using the option <code>targeting</code> = <code>"targeted"</code>.</p>
</div>

<div class="section">
<h5 id="-random-targeting"><code>"random"</code> targeting<a class="anchor" aria-label="anchor" href="#-random-targeting"></a></h5>


<p>A reasonable first assumption might be to use <code>targeting</code> =
<code>"random"</code>, meaning that individuals will receive vaccination
irrespective of their previous immunity status. The immunity after the
new campaign is applied is calculated according to</p>
<p>immunity_new = coverage + immunity_prev
- coverage * immunity_prev</p>
</div>

<div class="section">
<h5 id="-correlated-targeting"><code>"correlated"</code> targeting<a class="anchor" aria-label="anchor" href="#-correlated-targeting"></a></h5>


<p>On the opposite end of the spectrum is the most pessimistic assumption
that might apply in situations where there is unequal access to
vaccination: under <code>"correlated"</code> targeting, people who have
previously been immunised get vaccinated first in the new vaccination
activity, and those previously not immune will only receive any
vaccine if the new coverage extends further:</p>
<p>immunity_new = max(immunity_prev, coverage)</p>
<p>Note that the order in which vaccination activities are applied to a
population does not matter under any of the <code>targeting</code> assumptions.</p>
</div>


</div>


</div>

    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Tini Garske</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## set up population and vaccination activities:</span></span></span>
<span class="r-in"><span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="popim_population.html">popim_population</a></span><span class="op">(</span>region <span class="op">=</span> <span class="st">"UK"</span>, year_min <span class="op">=</span> <span class="fl">2000</span>, year_max <span class="op">=</span> <span class="fl">2005</span>,</span></span>
<span class="r-in"><span>                        age_min <span class="op">=</span> <span class="fl">0</span>, age_max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vacc</span> <span class="op">&lt;-</span> <span class="fu"><a href="popim_vacc_activities.html">popim_vacc_activities</a></span><span class="op">(</span>region <span class="op">=</span> <span class="st">"UK"</span>, year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2001</span>, <span class="fl">2002</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              age_first <span class="op">=</span> <span class="fl">0</span>, age_last <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                              coverage <span class="op">=</span> <span class="fl">0.8</span>, doses <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>                              targeting <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## update the population immunity based on the vaccination activities:</span></span></span>
<span class="r-in"><span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu">apply_vacc</span><span class="op">(</span><span class="va">pop</span>, <span class="va">vacc</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tini Garske.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

