<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>POPulation IMmunity: Run a Demographic Model of Vaccine Exposure Over Time • popim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="POPulation IMmunity: Run a Demographic Model of Vaccine Exposure Over Time">
<meta property="og:description" content="Tools for setting up an age-structured population,
    applying vaccination activities to it, and tracking
    vaccine-induced immunity through time.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">popim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/popim.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="popim">popim<a class="anchor" aria-label="anchor" href="#popim"></a>
</h1></div>
<!-- badges: start -->

<p><strong>POPulation IMmunity</strong></p>
<p>This repository contains functions to run a demographic model of vaccine exposure over time, tracking the vaccine-derived immunity by age through time, following implementation of one or more vaccination activities that can target the population as a whole or selectively target specific age groups.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of popim from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"mrc-ide/popim"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h2>
<p>This package defines an S3 class <code>popim_population</code> which is a dataframe with at least the columns year, age, cohort (the year of birth for the individuals tracked in this row), and immunity (as a proportion of this cohort). Year, age and cohort are tracked as annual time steps and age groups.</p>
<p>A basic, totally naive population dataframe can be setup using the function <code><a href="reference/popim_population.html">popim_population()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">popim</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/popim_population.html">popim_population</a></span><span class="op">(</span>region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UK"</span>, <span class="st">"FRA"</span><span class="op">)</span>, year_min <span class="op">=</span> <span class="fl">2000</span>, year_max <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>                        age_min <span class="op">=</span> <span class="fl">0</span>, age_max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 242   6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span>
<span><span class="co">#&gt;   region year age cohort immunity pop_size</span></span>
<span><span class="co">#&gt; 1     UK 2000   0   2000        0       NA</span></span>
<span><span class="co">#&gt; 2    FRA 2000   0   2000        0       NA</span></span>
<span><span class="co">#&gt; 3     UK 2001   0   2001        0       NA</span></span>
<span><span class="co">#&gt; 4    FRA 2001   0   2001        0       NA</span></span>
<span><span class="co">#&gt; 5     UK 2002   0   2002        0       NA</span></span>
<span><span class="co">#&gt; 6    FRA 2002   0   2002        0       NA</span></span></code></pre></div>
<p>This dataframe has 242 columns (2 regions x 11 age groups 0 - 10 x 11 years 2000 - 2020).</p>
<p>Next, we read in a file containing some vaccination activites into an object of the class <code>popim_vacc_activities</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vacc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_vacc_activities.html">read_vacc_activities</a></span><span class="op">(</span><span class="st">"inst/extdata/vacc_activities.csv"</span><span class="op">)</span></span>
<span><span class="va">vacc</span></span>
<span><span class="co">#&gt;   region year age_first age_last coverage doses targeting</span></span>
<span><span class="co">#&gt; 1     UK 1998         0       10     0.50    NA    random</span></span>
<span><span class="co">#&gt; 2     UK 2005         0        0     0.50    NA    random</span></span>
<span><span class="co">#&gt; 3     UK 2006         0        0     0.60    NA    random</span></span>
<span><span class="co">#&gt; 4     UK 2007         0        0     0.70    NA    random</span></span>
<span><span class="co">#&gt; 5     UK 2008         0        0     0.80    NA    random</span></span>
<span><span class="co">#&gt; 6     UK 2009         0        0     0.90    NA    random</span></span>
<span><span class="co">#&gt; 7     UK 2010         0        0     0.95    NA    random</span></span></code></pre></div>
<p>All vaccination activities target the UK. The first is a campaign targeting all age groups of our dummy population, which took place 2 years before the dawn of time. As immunity is assumed not to wane, the effects of this are still there, and therefore the functions here keep track of this. The remaining vaccination activities are routine vaccination of infants (restricted to age 0) with an increasing population of the target cohort to be vaccinated.</p>
<p>We now apply these vaccination activities sequentially to the population using the function <code>apply_vaccs()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/apply_vacc.html">apply_vacc</a></span><span class="op">(</span><span class="va">pop</span>, <span class="va">vacc</span><span class="op">)</span></span></code></pre></div>
<p>The resulting vaccine-derived immunity of the population can be visualised with the function <code><a href="reference/plotting.html">plot_immunity()</a></code>. This is based on ggplot2, and the returned graph object can be further modified - here in order to achieve tick marks that suit the data better.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co">## needed to amend the plot returned from plot_population()</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plotting.html">plot_immunity</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2010</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_immunity-1.png" width="100%"></p>
<p>As all vaccination activities target the “UK”, the population in “FRA” has no immunity at all. In the “UK”, the top left corner it shows the immunity remaining in the older age groups from the initial campaign, while the infant vaccination from 2005 onwards results in immuity in the lower right corner - and the increasing coverage highlights how cohorts age through time and therefore move through the plot in a diagonal fashion.</p>
</div>
<div class="section level2">
<h2 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h2>
<p>A more realistic scenario is to read in some real population data to set up the popim_population, and then apply some vaccination activities to this. Information on the vaccination activities may be given in coverage (typical for routine infant vaccination) or doses (typical for mass vaccination campaigns).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_popim_pop.html">read_popim_pop</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"inst/extdata/pop_sample.csv"</span><span class="op">)</span></span></code></pre></div>
<p>We have read in population data for India (“IND”) and Nigeria (“NGA”) for the period from 1950 to 2100. The age range covered is 0 to 100 year, and the population is set up as fully unvaccinated:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 30502     6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span>
<span><span class="co">#&gt;   region year age cohort immunity pop_size</span></span>
<span><span class="co">#&gt; 1    IND 1950   0   1950        0 13505495</span></span>
<span><span class="co">#&gt; 2    NGA 1950   0   1950        0  1438816</span></span>
<span><span class="co">#&gt; 3    IND 1951   0   1951        0 13860960</span></span>
<span><span class="co">#&gt; 4    NGA 1951   0   1951        0  1505894</span></span>
<span><span class="co">#&gt; 5    IND 1952   0   1952        0 14233779</span></span>
<span><span class="co">#&gt; 6    NGA 1952   0   1952        0  1535000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">pop</span><span class="op">$</span><span class="va">region</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   IND   NGA </span></span>
<span><span class="co">#&gt; 15251 15251</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">pop</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1950 2100</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">pop</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   0 100</span></span></code></pre></div>
<p>Now we read in some vaccination activities for Nigeria: some campaigns targeting all age groups, and some routine vaccination targeting only infants:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">campaigns</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_vacc_activities.html">read_vacc_activities</a></span><span class="op">(</span><span class="st">"inst/extdata/vacc_campaigns_NGA.csv"</span><span class="op">)</span></span>
<span><span class="va">campaigns</span></span>
<span><span class="co">#&gt;   region year age_first age_last coverage    doses targeting</span></span>
<span><span class="co">#&gt; 1    NGA 1971         0      100       NA  1496674    random</span></span>
<span><span class="co">#&gt; 2    NGA 1974         0      100       NA  1100000    random</span></span>
<span><span class="co">#&gt; 3    NGA 1987         0      100       NA 17000000    random</span></span>
<span><span class="co">#&gt; 4    NGA 1989         0      100       NA 14000000    random</span></span>
<span></span>
<span><span class="va">routine</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_vacc_activities.html">read_vacc_activities</a></span><span class="op">(</span><span class="st">"inst/extdata/vacc_routine_NGA.csv"</span><span class="op">)</span></span>
<span><span class="va">routine</span></span>
<span><span class="co">#&gt;    region year age_first age_last  coverage doses targeting</span></span>
<span><span class="co">#&gt; 1     NGA 1990         0        0 0.3308515    NA    random</span></span>
<span><span class="co">#&gt; 2     NGA 1991         0        0 0.3181156    NA    random</span></span>
<span><span class="co">#&gt; 3     NGA 1992         0        0 0.3062463    NA    random</span></span>
<span><span class="co">#&gt; 4     NGA 1993         0        0 0.2949784    NA    random</span></span>
<span><span class="co">#&gt; 5     NGA 1994         0        0 0.2847963    NA    random</span></span>
<span><span class="co">#&gt; 6     NGA 1995         0        0 0.2748206    NA    random</span></span>
<span><span class="co">#&gt; 7     NGA 1996         0        0 0.2646241    NA    random</span></span>
<span><span class="co">#&gt; 8     NGA 1997         0        0 0.2548750    NA    random</span></span>
<span><span class="co">#&gt; 9     NGA 1998         0        0 0.2455467    NA    random</span></span>
<span><span class="co">#&gt; 10    NGA 1999         0        0 0.2366186    NA    random</span></span>
<span><span class="co">#&gt; 11    NGA 2000         0        0 0.2280252    NA    random</span></span>
<span><span class="co">#&gt; 12    NGA 2001         0        0 0.2191378    NA    random</span></span>
<span><span class="co">#&gt; 13    NGA 2002         0        0 0.2106511    NA    random</span></span>
<span><span class="co">#&gt; 14    NGA 2003         0        0 0.2025363    NA    random</span></span>
<span><span class="co">#&gt; 15    NGA 2004         0        0 0.1947333    NA    random</span></span>
<span><span class="co">#&gt; 16    NGA 2005         0        0 0.1951376    NA    random</span></span>
<span><span class="co">#&gt; 17    NGA 2006         0        0 0.2006093    NA    random</span></span>
<span><span class="co">#&gt; 18    NGA 2007         0        0 0.2089055    NA    random</span></span>
<span><span class="co">#&gt; 19    NGA 2008         0        0 0.2202815    NA    random</span></span>
<span><span class="co">#&gt; 20    NGA 2009         0        0 0.2297419    NA    random</span></span>
<span><span class="co">#&gt; 21    NGA 2010         0        0 0.2458946    NA    random</span></span>
<span><span class="co">#&gt; 22    NGA 2011         0        0 0.2685779    NA    random</span></span>
<span><span class="co">#&gt; 23    NGA 2012         0        0 0.2849166    NA    random</span></span>
<span><span class="co">#&gt; 24    NGA 2013         0        0 0.3009589    NA    random</span></span></code></pre></div>
<p>Note that in this dataset the extent of the campaigns is given in the number of vaccine doses administered (assuming no wastage, so this equates to the number of people vaccinated), while the routine vaccination is given as coverage, i.e., the proportion of the targeted age cohort to be vaccinated.</p>
<p>If we know the population size that is targeted, we can convert between doses and coverage, and there is a function <code><a href="reference/complete_vacc_activities.html">complete_vacc_activities()</a></code> to fill in whichever one is missing:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">campaigns_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/complete_vacc_activities.html">complete_vacc_activities</a></span><span class="op">(</span><span class="va">campaigns</span>, <span class="va">pop</span><span class="op">)</span></span>
<span><span class="va">campaigns_complete</span></span>
<span><span class="co">#&gt;   region year age_first age_last   coverage    doses targeting</span></span>
<span><span class="co">#&gt; 1    NGA 1971         0      100 0.02633246  1496674    random</span></span>
<span><span class="co">#&gt; 2    NGA 1974         0      100 0.01798622  1100000    random</span></span>
<span><span class="co">#&gt; 3    NGA 1987         0      100 0.19308487 17000000    random</span></span>
<span><span class="co">#&gt; 4    NGA 1989         0      100 0.15095306 14000000    random</span></span>
<span></span>
<span><span class="va">routine_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/complete_vacc_activities.html">complete_vacc_activities</a></span><span class="op">(</span><span class="va">routine</span>, <span class="va">pop</span><span class="op">)</span></span>
<span><span class="va">routine_complete</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   region year age_first age_last  coverage   doses targeting</span></span>
<span><span class="co">#&gt; 1    NGA 1990         0        0 0.3308515 1252267    random</span></span>
<span><span class="co">#&gt; 2    NGA 1991         0        0 0.3181156 1231267    random</span></span>
<span><span class="co">#&gt; 3    NGA 1992         0        0 0.3062463 1214359    random</span></span>
<span><span class="co">#&gt; 4    NGA 1993         0        0 0.2949784 1201231    random</span></span>
<span><span class="co">#&gt; 5    NGA 1994         0        0 0.2847963 1192498    random</span></span>
<span><span class="co">#&gt; 6    NGA 1995         0        0 0.2748206 1181349    random</span></span></code></pre></div>
<p>We now apply first the campaigns, then the routine vaccination to the population, and visualise the resulting population immunity. Note that we can use either the original or completed versions of the vaccination activities.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/apply_vacc.html">apply_vacc</a></span><span class="op">(</span><span class="va">pop</span>, <span class="va">campaigns</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotting.html">plot_immunity</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_immunity_2-1.png" width="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/apply_vacc.html">apply_vacc</a></span><span class="op">(</span><span class="va">pop</span>, <span class="va">routine</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plotting.html">plot_immunity</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_immunity_2-2.png" width="100%"></p>
<p>The overall population immunity can be aggregated across ages using the function <code><a href="reference/calc_pop_immunity.html">calc_pop_immunity()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calc_pop_immunity.html">calc_pop_immunity</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span></span>
<span><span class="va">pop_agg</span></span>
<span><span class="co">#&gt; # A tibble: 302 × 4</span></span>
<span><span class="co">#&gt; # Groups:   region [2]</span></span>
<span><span class="co">#&gt;    region  year   pop_size immunity</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;  &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 IND     1950 357021100.        0</span></span>
<span><span class="co">#&gt;  2 IND     1951 364922360.        0</span></span>
<span><span class="co">#&gt;  3 IND     1952 372997188         0</span></span>
<span><span class="co">#&gt;  4 IND     1953 381227705         0</span></span>
<span><span class="co">#&gt;  5 IND     1954 389731406         0</span></span>
<span><span class="co">#&gt;  6 IND     1955 398577992.        0</span></span>
<span><span class="co">#&gt;  7 IND     1956 407656597         0</span></span>
<span><span class="co">#&gt;  8 IND     1957 416935400.        0</span></span>
<span><span class="co">#&gt;  9 IND     1958 426295762.        0</span></span>
<span><span class="co">#&gt; 10 IND     1959 435900352.        0</span></span>
<span><span class="co">#&gt; # ℹ 292 more rows</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pop_agg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">immunity</span>, col <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-calc_pop_immunity-1.png" width="100%"></p>
<p>Given a <code>popim_population</code> object, the vaccination activities that would be needed to achieve the specified population immunity can be inferred with the function <code><a href="reference/vacc_from_immunity.html">vacc_from_immunity()</a></code>, given an assumption on the targeting method of the vaccination activities. Using this function on the population we have just constructed does indeed yield the original vaccination activities back:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">vacc_act</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/vacc_from_immunity.html">vacc_from_immunity</a></span><span class="op">(</span><span class="va">pop</span>, targeting <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span></span>
<span><span class="va">vacc_act</span></span>
<span><span class="co">#&gt;    region year age_first age_last   coverage    doses targeting</span></span>
<span><span class="co">#&gt; 1     NGA 1971         0       99 0.02633246  1496674    random</span></span>
<span><span class="co">#&gt; 2     NGA 1974         0       99 0.01798622  1100000    random</span></span>
<span><span class="co">#&gt; 3     NGA 1987         0       99 0.19308487 16999989    random</span></span>
<span><span class="co">#&gt; 4     NGA 1989         0       99 0.15095306 13999990    random</span></span>
<span><span class="co">#&gt; 5     NGA 1990         0        0 0.33085152  1252267    random</span></span>
<span><span class="co">#&gt; 6     NGA 1991         0        0 0.31811556  1231267    random</span></span>
<span><span class="co">#&gt; 7     NGA 1992         0        0 0.30624627  1214359    random</span></span>
<span><span class="co">#&gt; 8     NGA 1993         0        0 0.29497841  1201231    random</span></span>
<span><span class="co">#&gt; 9     NGA 1994         0        0 0.28479626  1192498    random</span></span>
<span><span class="co">#&gt; 10    NGA 1995         0        0 0.27482056  1181349    random</span></span>
<span><span class="co">#&gt; 11    NGA 1996         0        0 0.26462412  1163875    random</span></span>
<span><span class="co">#&gt; 12    NGA 1997         0        0 0.25487501  1143137    random</span></span>
<span><span class="co">#&gt; 13    NGA 1998         0        0 0.24554675  1122657    random</span></span>
<span><span class="co">#&gt; 14    NGA 1999         0        0 0.23661858  1112862    random</span></span>
<span><span class="co">#&gt; 15    NGA 2000         0        0 0.22802523  1110595    random</span></span>
<span><span class="co">#&gt; 16    NGA 2001         0        0 0.21913782  1101837    random</span></span>
<span><span class="co">#&gt; 17    NGA 2002         0        0 0.21065106  1090764    random</span></span>
<span><span class="co">#&gt; 18    NGA 2003         0        0 0.20253629  1077450    random</span></span>
<span><span class="co">#&gt; 19    NGA 2004         0        0 0.19473330  1060944    random</span></span>
<span><span class="co">#&gt; 20    NGA 2005         0        0 0.19513761  1089823    random</span></span>
<span><span class="co">#&gt; 21    NGA 2006         0        0 0.20060929  1149092    random</span></span>
<span><span class="co">#&gt; 22    NGA 2007         0        0 0.20890546  1225697    random</span></span>
<span><span class="co">#&gt; 23    NGA 2008         0        0 0.22028150  1326200    random</span></span>
<span><span class="co">#&gt; 24    NGA 2009         0        0 0.22974189  1417495    random</span></span>
<span><span class="co">#&gt; 25    NGA 2010         0        0 0.24589456  1549583    random</span></span>
<span><span class="co">#&gt; 26    NGA 2011         0        0 0.26857787  1728120    random</span></span>
<span><span class="co">#&gt; 27    NGA 2012         0        0 0.28491655  1866237    random</span></span>
<span><span class="co">#&gt; 28    NGA 2013         0        0 0.30095890  1997462    random</span></span></code></pre></div>
<!-- You'll still need to render `README.Rmd` regularly, to keep -->
<!-- `README.md` up-to-date. `devtools::build_readme()` is handy for -->
<!-- this. You could also use GitHub Actions to re-render `README.Rmd` -->
<!-- every time you push. An example workflow can be found here: -->
<!-- <https://github.com/r-lib/actions/tree/v1/examples>. -->
<!-- You can also embed plots, for example: -->
<!-- ```{r pressure, echo = FALSE} -->
<!-- plot(pressure) -->
<!-- ``` -->
<!-- In that case, don't forget to commit and push the resulting figure -->
<!-- files, so they display on GitHub and CRAN. -->
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing popim</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tini Garske <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8952-4710" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mrc-ide/popim/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/mrc-ide/popim/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Tini Garske.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
